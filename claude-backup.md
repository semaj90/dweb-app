# Claude Context - Deeds Legal AI Web App ## Project Overview Modern legal AI assistant web application built with Svelte 5, SvelteKit 2.16+, and comprehensive MCP (Model Context Protocol) server integration for enhanced AI development capabilities. ## Architecture & Stack - **Framework**: SvelteKit 2.16.0 with Svelte 5.0.0 (runes, snippets, effects) - **Styling**: UnoCSS 66.3.2 + Tailwind + Vanilla CSS (multi-layer approach) - **UI Components**: bits-ui 2.8.10 (latest) + Melt UI for accessible components - **Database**: PostgreSQL with Drizzle ORM 0.44.2 + pgvector for embeddings - **Auth**: Lucia Auth v3 with Drizzle adapter + @auth/sveltekit - **AI Integration**: Ollama + Gemma3 Legal model + vector search - **Rich Text**: TipTap editor + TinyMCE integration - **Validation**: Zod for schema validation + Superforms - **Testing**: Playwright for E2E testing - **Build Tool**: Vite 6.3.5 ## Project Structure ``` deeds-web-app/ ├── sveltekit-frontend/ # Main SvelteKit application │ ├── src/ │ │ ├── routes/ # SvelteKit routes │ │ ├── lib/ # Shared components and utilities │ │ │ ├── components/ # Svelte 5 components │ │ │ ├── server/ # Server-only code │ │ │ └── stores/ # Svelte stores │ │ ├── app.html # App shell │ │ └── hooks.server.ts # Server hooks │ ├── static/ # Static assets │ ├── tests/ # Playwright tests │ └── package.json ├── drizzle/ # Database migrations ├── docker-compose.yml # Database and Ollama services ├── scripts/ # Setup and utility scripts └── .vscode/ # VS Code configuration └── settings.json # MCP server configurations ``` ## Svelte 5 Best Practices ### Runes System ```typescript <script lang="ts"> // State runes for reactive state let count = $state(0); let user = $state<User | null>(null); let items = $state<Item[]>([]); // Derived state let doubled = $derived(count * 2); let isLoggedIn = $derived(user !== null); // Props with defaults interface Props { title?: string; variant?: "primary" | "secondary"; } let { title = "Default", variant = "primary" }: Props = $props(); // Effects for side effects $effect(() => { document.title = title; }); // Cleanup effects $effect(() => { const interval = setInterval(() => count++, 1000); return () => clearInterval(interval); }); </script> ``` ### Component Composition with Snippets ```typescript <script lang="ts"> import type { Snippet } from "svelte"; interface Props { children: Snippet; header?: Snippet<[{ title: string }]>; variant?: "card" | "modal"; } let { children, header, variant = "card" }: Props = $props(); const classes = $derived({ card: "bg-white rounded-lg shadow-md p-6", modal: "fixed inset-0 bg-white rounded-lg max-w-md mx-auto" }[variant]); </script> <div class={classes}> {#if header} <header class="mb-4"> {@render header({ title: "Dynamic Title" })} </header> {/if} <main> {@render children()} </main> </div> ``` ## MCP Server Integration ### Active MCP Servers 1. **file-management**: Filesystem operations restricted to project directory 2. **memory**: Persistent memory across AI assistant sessions 3. **postgres**: Database operations and schema management 4. **svelte-llm**: Svelte 5 and SvelteKit specific expertise ### Configuration Guidelines - All MCP servers auto-start with VS Code - Configured for all Copilot models (GPT-4, Claude, Gemini, O-models) - Environment variables properly secured - Real-time file watching for development ### Usage Patterns - Use filesystem MCP for safe file operations - Leverage memory MCP for session persistence - Use svelte-llm MCP for Svelte 5-specific code generation - Apply postgres MCP for database schema management ## Database Integration with Drizzle ### Schema Patterns ```typescript // lib/server/db/schema.ts import { pgTable, serial, text, timestamp, boolean, integer, vector } from "drizzle-orm/pg-core"; import { relations } from "drizzle-orm"; export const cases = pgTable("cases", { id: serial("id").primaryKey(), title: text("title").notNull(), description: text("description"), status: text("status", { enum: ["open", "closed", "pending"] }).default("open"), embedding: vector("embedding", { dimensions: 1536 }), createdAt: timestamp("created_at").defaultNow().notNull(), updatedAt: timestamp("updated_at").defaultNow().notNull() }); export const evidence = pgTable("evidence", { id: serial("id").primaryKey(), caseId: integer("case_id").references(() => cases.id).notNull(), filename: text("filename").notNull(), content: text("content"), embedding: vector("embedding", { dimensions: 1536 }), uploadedAt: timestamp("uploaded_at").defaultNow().notNull() }); export const casesRelations = relations(cases, ({ many }) => ({ evidence: many(evidence) })); ``` ### Vector Search Integration ```typescript // lib/server/vector-search.ts import { db } from "./db"; import { cases, evidence } from "./schema"; import { cosineDistance, sql } from "drizzle-orm"; export async function searchSimilarCases(query: string, limit = 10) { const embedding = await generateEmbedding(query); return await db .select() .from(cases) .orderBy(cosineDistance(cases.embedding, embedding)) .limit(limit); } ``` ## UnoCSS Configuration ### Multi-Layer Styling Approach ```typescript // unocss.config.ts import { defineConfig, presetUno, presetTypography } from "unocss"; export default defineConfig({ presets: [ presetUno(), presetTypography() ], shortcuts: { // Layout shortcuts "flex-center": "flex items-center justify-center", "flex-between": "flex items-center justify-between", // Component shortcuts "btn": "inline-flex items-center justify-center rounded-md font-medium transition-all duration-200", "btn-primary": "btn bg-blue-600 text-white hover:bg-blue-700 focus:ring-2 focus:ring-blue-500", "card": "bg-white rounded-lg shadow-md border border-gray-200 p-6", "input-field": "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" }, theme: { colors: { primary: { 50: "#eff6ff", 500: "#3b82f6", 900: "#1e3a8a" } } } }); ``` ## AI Assistant Guidelines ### Code Generation Priorities 1. **Svelte 5 First**: Use runes, snippets, and modern patterns 2. **Type Safety**: Generate comprehensive TypeScript types 3. **Accessibility**: Implement ARIA attributes and semantic HTML 4. **Performance**: Optimize for Core Web Vitals 5. **Legal Domain**: Understand legal terminology and workflows ### Component Development - Use bits-ui for accessible foundations - Implement proper Svelte 5 component patterns - Apply consistent styling with UnoCSS shortcuts - Include proper TypeScript interfaces - Add comprehensive error boundaries ### Database Operations - Use Drizzle ORM with type-safe queries - Implement vector search for legal documents - Apply security best practices for legal data - Use prepared statements for performance This comprehensive context ensures that all AI assistants understand the modern Svelte 5 + SvelteKit architecture with multi-layer CSS, PostgreSQL + vector search integration, and MCP server capabilities for enhanced legal AI development assistance.
